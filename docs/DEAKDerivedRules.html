<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>Theory DEAKDerivedRules (Isabelle2017: October 2017)</title>
<link media="all" rel="stylesheet" type="text/css" href="isabelle.css"/>
</head>

<body>
<div class="head"><h1>Theory DEAKDerivedRules</h1>

<span class="command">theory</span> <span class="name">DEAKDerivedRules</span><br/>
<span class="keyword">imports</span> <a href="DEAK_SE.html"><span class="name">DEAK_SE</span></a> <a href="NatToString.html"><span class="name">NatToString</span></a><br/>

</div>
<div class="source">
<pre class="source"><span class="keyword1"><span class="command">theory</span></span><span class=""> </span><span class="">DEAKDerivedRules</span><span class="">
</span><span class="keyword2"><span class="keyword">imports</span></span><span class=""> </span><span class="">Main</span><span class=""> </span><span class="string">&quot;calculus/src/isabelle/DEAK_SE&quot;</span><span class=""> </span><span class="">NatToString</span><span class="">
</span><span class="keyword2"><span class="keyword">begin</span></span><span class="">
</span><span class="">
</span><span class="comment">(* The Id rule where for every formula f, f <span class="hidden">&#8681;</span><sub>S</sub> &#8866;<span class="hidden">&#8681;</span><sub>S</sub> f <span class="hidden">&#8681;</span><sub>S</sub> is derivable *)</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">Id</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">fixes</span></span><span class=""> </span><span class="">f</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="">Formula</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">shows</span></span><span class=""> </span><span class="string">&quot;loc &#8866;d f <span class="hidden">&#8681;</span><sub>S</sub> &#8866;<span class="hidden">&#8681;</span><sub>S</sub> f <span class="hidden">&#8681;</span><sub>S</sub>&quot;</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">f</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.FboxA_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.FboxA_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.FdiamA_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.FdiamA_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.BboxA_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.BboxA_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.BdiamA_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.BdiamA_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.FboxK_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.FboxK_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.FdiamK_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.FdiamK_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.BboxK_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.BboxK_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.BdiamK_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.BdiamK_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Id</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.ImpL_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.ImpL_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.DImpL_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.DImpL_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.DImpR_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.DImpR_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Or_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Or_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.ImpR_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.ImpR_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.One_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.One_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Top_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Top_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Bot_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Bot_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">definition</span></span><span class=""> </span><span class="">disj</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;Formula list &#8658; Formula&quot;</span><span class=""> </span><span class="delimiter">(</span><span class="string">&quot;&#8897;<span class="hidden">&#8681;</span><sub>F</sub> _&quot;</span><span class=""> </span><span class="">300</span><span class="delimiter">)</span><span class=""> </span><span class="keyword2"><span class="keyword">where</span></span><span class="">
</span><span class="string">&quot;disj list = foldr (Formula_Or) list &#8869;<span class="hidden">&#8681;</span><sub>F</sub>&quot;</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">disj_unfold_1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(&#8897;<span class="hidden">&#8681;</span><sub>F</sub> (x#list)) = x &#8744;<span class="hidden">&#8681;</span><sub>F</sub> (&#8897;<span class="hidden">&#8681;</span><sub>F</sub> list)&quot;</span><span class=""> </span><span class="keyword1"><span class="command">unfolding</span></span><span class=""> </span><span class="">disj_def</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">definition</span></span><span class=""> </span><span class="">conj</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;Formula list &#8658; Formula&quot;</span><span class=""> </span><span class="delimiter">(</span><span class="string">&quot;&#8896;<span class="hidden">&#8681;</span><sub>F</sub> _&quot;</span><span class=""> </span><span class="">300</span><span class="delimiter">)</span><span class=""> </span><span class="keyword2"><span class="keyword">where</span></span><span class="">
</span><span class="string">&quot;conj list = foldr (Formula_And) list &#8868;<span class="hidden">&#8681;</span><sub>F</sub>&quot;</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">conj_unfold_1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(&#8896;<span class="hidden">&#8681;</span><sub>F</sub> (x#list)) = x &#8743;<span class="hidden">&#8681;</span><sub>F</sub> (&#8896;<span class="hidden">&#8681;</span><sub>F</sub> list)&quot;</span><span class=""> </span><span class="keyword1"><span class="command">unfolding</span></span><span class=""> </span><span class="">conj_def</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">conj_unfold_1a</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(&#8896;<span class="hidden">&#8681;</span><sub>F</sub> (map f (x#list))) = (f x) &#8743;<span class="hidden">&#8681;</span><sub>F</sub> (&#8896;<span class="hidden">&#8681;</span><sub>F</sub> map f list)&quot;</span><span class=""> </span><span class="keyword1"><span class="command">unfolding</span></span><span class=""> </span><span class="">conj_def</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">conj_unfold_2</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">assumes</span></span><span class=""> </span><span class="">cut</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8896;f. CutFormula f &#8712; set loc&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">shows</span></span><span class=""> </span><span class="string">&quot;loc &#8866;d (&#8896;<span class="hidden">&#8681;</span><sub>F</sub> (list1@list2)) <span class="hidden">&#8681;</span><sub>S</sub> &#8866;<span class="hidden">&#8681;</span><sub>S</sub> ((&#8896;<span class="hidden">&#8681;</span><sub>F</sub> list1) &#8743;<span class="hidden">&#8681;</span><sub>F</sub> (&#8896;<span class="hidden">&#8681;</span><sub>F</sub> list2)) <span class="hidden">&#8681;</span><sub>S</sub>&quot;</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">list1</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">subst</span><span class=""> </span><span class="">conj_def</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.C_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">Id</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.IW_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Top_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command">proof</span></span><span class=""> </span><span class="">goal_cases</span><span class="">
</span><span class="">  </span><span class="keyword3"><span class="command">case</span></span><span class=""> </span><span class="delimiter">(</span><span class="">1</span><span class=""> </span><span class="">a</span><span class=""> </span><span class="">list1</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">have</span></span><span class=""> </span><span class="">2</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(a # list1) @ list2 = a # (list1 @ list2)&quot;</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword3"><span class="command">show</span></span><span class=""> </span><span class="var">?case</span><span class=""> </span><span class="keyword1"><span class="command">unfolding</span></span><span class=""> </span><span class="">2</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">subst</span><span class=""> </span><span class="">conj_unfold_1</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">subst</span><span class=""> </span><span class="">conj_unfold_1</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.C_L</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_R</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_L</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impL_disp2</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.W_impL_L</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">f</span><span class="delimiter">=</span><span class="string">&quot;(&#8896;<span class="hidden">&#8681;</span><sub>F</sub> list1) &#8743;<span class="hidden">&#8681;</span><sub>F</sub> (&#8896;<span class="hidden">&#8681;</span><sub>F</sub> list2)&quot;</span><span class=""> </span><span class="keyword2"><span class="keyword">in</span></span><span class=""> </span><span class="">derivable.SingleCut</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">cut</span><span class=""> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">1</span><span class=""> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_L</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impL_disp2</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.W_impL_L</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">Id</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_L</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_R</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">f</span><span class="delimiter">=</span><span class="string">&quot;(&#8896;<span class="hidden">&#8681;</span><sub>F</sub> list1) &#8743;<span class="hidden">&#8681;</span><sub>F</sub> (&#8896;<span class="hidden">&#8681;</span><sub>F</sub> list2)&quot;</span><span class=""> </span><span class="keyword2"><span class="keyword">in</span></span><span class=""> </span><span class="">derivable.SingleCut</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">cut</span><span class=""> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">1</span><span class=""> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_L</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impR_disp2</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.W_impR_R</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">Id</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">Id</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command">qed</span></span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">conj_unfold_2b</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">assumes</span></span><span class=""> </span><span class="">cut</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8896;f. CutFormula f &#8712; set loc&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">shows</span></span><span class=""> </span><span class="string">&quot;loc &#8866;d ((&#8896;<span class="hidden">&#8681;</span><sub>F</sub> list1) &#8743;<span class="hidden">&#8681;</span><sub>F</sub> (&#8896;<span class="hidden">&#8681;</span><sub>F</sub> list2)) <span class="hidden">&#8681;</span><sub>S</sub> &#8866;<span class="hidden">&#8681;</span><sub>S</sub> (&#8896;<span class="hidden">&#8681;</span><sub>F</sub> (list1@list2)) <span class="hidden">&#8681;</span><sub>S</sub>&quot;</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">list1</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">subst</span><span class=""> </span><span class="">conj_def</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impL_disp2</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.W_impL_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">Id</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command">proof</span></span><span class=""> </span><span class="">goal_cases</span><span class="">
</span><span class="">  </span><span class="keyword3"><span class="command">case</span></span><span class=""> </span><span class="delimiter">(</span><span class="">1</span><span class=""> </span><span class="">a</span><span class=""> </span><span class="">list1</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">have</span></span><span class=""> </span><span class="">2</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(a # list1) @ list2 = a # (list1 @ list2)&quot;</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword3"><span class="command">show</span></span><span class=""> </span><span class="var">?case</span><span class=""> </span><span class="keyword1"><span class="command">unfolding</span></span><span class=""> </span><span class="">2</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">subst</span><span class=""> </span><span class="">conj_unfold_1</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">subst</span><span class=""> </span><span class="">conj_unfold_1</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.C_L</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_R</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_L</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impL_disp2</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_L</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impL_disp2</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.W_impL_L</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impL_disp</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">f</span><span class="delimiter">=</span><span class="string">&quot;(&#8896;<span class="hidden">&#8681;</span><sub>F</sub> list1) &#8743;<span class="hidden">&#8681;</span><sub>F</sub> (&#8896;<span class="hidden">&#8681;</span><sub>F</sub> list2)&quot;</span><span class=""> </span><span class="keyword2"><span class="keyword">in</span></span><span class=""> </span><span class="">derivable.SingleCut</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">cut</span><span class=""> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_R</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">Id</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">Id</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">1</span><span class=""> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_L</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impR_disp2</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.W_impR_R</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_L</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impR_disp2</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.W_impR_R</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">Id</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command">qed</span></span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">conj_fold</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">assumes</span></span><span class=""> </span><span class="">cut</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8896;f. CutFormula f &#8712; set loc&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">shows</span></span><span class=""> </span><span class="string">&quot;loc &#8866;d (&#8896;<span class="hidden">&#8681;</span><sub>F</sub> map (&#955;x. f x &#8743;<span class="hidden">&#8681;</span><sub>F</sub> f&#39; x) l) <span class="hidden">&#8681;</span><sub>S</sub> &#8866;<span class="hidden">&#8681;</span><sub>S</sub> ((&#8896;<span class="hidden">&#8681;</span><sub>F</sub> map f l) &#8743;<span class="hidden">&#8681;</span><sub>F</sub> (&#8896;<span class="hidden">&#8681;</span><sub>F</sub> map f&#39; l)) <span class="hidden">&#8681;</span><sub>S</sub>&quot;</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">l</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">subst</span><span class=""> </span><span class="">conj_def</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Top_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.C_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Top_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Top_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">subst</span><span class=""> </span><span class="">conj_unfold_1a</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">f</span><span class="delimiter">=</span><span class="string">&quot;(f a &#8743;<span class="hidden">&#8681;</span><sub>F</sub> f&#39; a) &#8743;<span class="hidden">&#8681;</span><sub>F</sub> ((&#8896;<span class="hidden">&#8681;</span><sub>F</sub> map f l) &#8743;<span class="hidden">&#8681;</span><sub>F</sub> (&#8896;<span class="hidden">&#8681;</span><sub>F</sub> map f&#39; l))&quot;</span><span class=""> </span><span class="keyword2"><span class="keyword">in</span></span><span class=""> </span><span class="">derivable.SingleCut</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">cut</span><span class=""> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">Id</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">Id</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.C_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_L</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impL_disp2</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.W_impL_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">Id</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impL_disp2</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.W_impL_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">Id</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impR_disp2</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.W_impR_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">Id</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impR_disp2</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.W_impR_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">Id</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">conj_impl_fold</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">assumes</span></span><span class=""> </span><span class="">cut</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8896;f. CutFormula f &#8712; set loc&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">shows</span></span><span class=""> </span><span class="string">&quot;loc &#8866;d ((&#8896;<span class="hidden">&#8681;</span><sub>F</sub> map f list) <span class="hidden">&#8681;</span><sub>S</sub>) ;<span class="hidden">&#8681;</span><sub>S</sub> ((&#8896;<span class="hidden">&#8681;</span><sub>F</sub> map (&#955;y. f y &#8594;<span class="hidden">&#8681;</span><sub>F</sub> f&#39; y) list) <span class="hidden">&#8681;</span><sub>S</sub>) &#8866;<span class="hidden">&#8681;</span><sub>S</sub> (&#8896;<span class="hidden">&#8681;</span><sub>F</sub> map f&#39; list) <span class="hidden">&#8681;</span><sub>S</sub>&quot;</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">list</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">subst</span><span class=""> </span><span class="">conj_def</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.IW_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Top_R</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">subst</span><span class=""> </span><span class="">conj_unfold_1a</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.C_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">defer</span></span></span></span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impL_disp2</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impR_disp2</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.W_impR_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impL_disp</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impR_disp2</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impR_disp2</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.W_impR_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.ImpR_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">Id</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">Id</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impL_disp2</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impL_disp2</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.W_impL_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impL_disp</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impR_disp2</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impL_disp2</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.W_impL_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impR_disp</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">conj_der1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;loc &#8866;d ( f )<span class="hidden">&#8681;</span><sub>S</sub> &#8866;<span class="hidden">&#8681;</span><sub>S</sub> X &#10233; f &#8712; set list &#10233; loc &#8866;d ( &#8896;<span class="hidden">&#8681;</span><sub>F</sub> list )<span class="hidden">&#8681;</span><sub>S</sub> &#8866;<span class="hidden">&#8681;</span><sub>S</sub> X&quot;</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">list</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command">proof</span></span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class="delimiter">,</span><span class=""> </span><span class="">goal_cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword3"><span class="command">case</span></span><span class=""> </span><span class="delimiter">(</span><span class="">1</span><span class=""> </span><span class="">a</span><span class=""> </span><span class="">list</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword3"><span class="command">thus</span></span><span class=""> </span><span class="var">?case</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">cases</span><span class=""> </span><span class="string">&quot;f &#8712; set list&quot;</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">subst</span><span class=""> </span><span class="">conj_unfold_1</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_L</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impL_disp2</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.W_impL_L</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">proof</span></span><span class=""> </span><span class="">goal_cases</span><span class="">
</span><span class="">    </span><span class="keyword3"><span class="command">case</span></span><span class=""> </span><span class="">1</span><span class=""> 
</span><span class="">    </span><span class="keyword1"><span class="command">then</span></span><span class=""> </span><span class="keyword1"><span class="command">have</span></span><span class=""> </span><span class="string">&quot;f = a&quot;</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">    </span><span class="keyword3"><span class="command">thus</span></span><span class=""> </span><span class="var">?case</span><span class="">
</span><span class="">    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">subst</span><span class=""> </span><span class="">conj_unfold_1</span><span class="delimiter">)</span><span class="">
</span><span class="">    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_L</span><span class="delimiter">)</span><span class="">
</span><span class="">    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impR_disp2</span><span class="delimiter">)</span><span class="">
</span><span class="">    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.W_impR_R</span><span class="delimiter">)</span><span class="">
</span><span class="">    </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">1</span><span class=""> </span><span class="">Id</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">qed</span></span><span class="">
</span><span class="keyword1"><span class="command">qed</span></span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">conj_der1b</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot; &#8704;f &#8712; set list. loc &#8866;d X  &#8866;<span class="hidden">&#8681;</span><sub>S</sub> ( f )<span class="hidden">&#8681;</span><sub>S</sub> &#10233; loc &#8866;d X &#8866;<span class="hidden">&#8681;</span><sub>S</sub> ( &#8896;<span class="hidden">&#8681;</span><sub>F</sub> list )<span class="hidden">&#8681;</span><sub>S</sub>&quot;</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">list</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class=""> 
</span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">IW_L</span><span class=""> </span><span class="">Top_R</span><span class=""> </span><span class="">conj_def</span><span class=""> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command">proof</span></span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class="delimiter">,</span><span class=""> </span><span class="">goal_cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword3"><span class="command">case</span></span><span class=""> </span><span class="delimiter">(</span><span class="">1</span><span class=""> </span><span class="">a</span><span class=""> </span><span class="">list</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword3"><span class="command">show</span></span><span class=""> </span><span class="var">?case</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">subst</span><span class=""> </span><span class="">conj_unfold_1</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.C_L</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_R</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">defer</span></span></span></span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">1</span><span class=""> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">1</span><span class=""> </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">IW_L</span><span class=""> </span><span class="">Top_R</span><span class=""> </span><span class="">conj_def</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">fastforce</span><span class="">
</span><span class="keyword1"><span class="command">qed</span></span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">conj_der2_aux</span><span class="delimiter">:</span><span class=""> 
</span><span class="">  </span><span class="keyword2"><span class="keyword">fixes</span></span><span class=""> </span><span class="">l&#39;</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">shows</span></span><span class=""> </span><span class="string">&quot;&#8896; l. set l&#39; &#8838; set l &#10233; loc &#8866;d ( &#8896;<span class="hidden">&#8681;</span><sub>F</sub> l )<span class="hidden">&#8681;</span><sub>S</sub> &#8866;<span class="hidden">&#8681;</span><sub>S</sub> ( &#8896;<span class="hidden">&#8681;</span><sub>F</sub> l&#39; )<span class="hidden">&#8681;</span><sub>S</sub>&quot;</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">l&#39;</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">subst</span><span class=""> </span><span class="delimiter">(</span><span class="">2</span><span class="delimiter">)</span><span class=""> </span><span class="">conj_def</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.IW_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Top_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command">proof</span></span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class="delimiter">,</span><span class=""> </span><span class="">goal_cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword3"><span class="command">case</span></span><span class=""> </span><span class="delimiter">(</span><span class="">1</span><span class=""> </span><span class="">a</span><span class=""> </span><span class="">l&#39;</span><span class=""> </span><span class="">l</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">then</span></span><span class=""> </span><span class="keyword1"><span class="command">have</span></span><span class=""> </span><span class="string">&quot;loc &#8866;d (&#8896;<span class="hidden">&#8681;</span><sub>F</sub> l) <span class="hidden">&#8681;</span><sub>S</sub> &#8866;<span class="hidden">&#8681;</span><sub>S</sub> (&#8896;<span class="hidden">&#8681;</span><sub>F</sub> l&#39;) <span class="hidden">&#8681;</span><sub>S</sub>&quot;</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword3"><span class="command">thus</span></span><span class=""> </span><span class="var">?case</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.C_L</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">subst</span><span class=""> </span><span class="">conj_unfold_1</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_R</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">f</span><span class="delimiter">=</span><span class="">a</span><span class=""> </span><span class="keyword2"><span class="keyword">in</span></span><span class=""> </span><span class="">conj_der1</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">Id</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">1</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command">qed</span></span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">conj_der2</span><span class="delimiter">:</span><span class=""> 
</span><span class="">  </span><span class="keyword2"><span class="keyword">fixes</span></span><span class=""> </span><span class="">l&#39;</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">assumes</span></span><span class=""> </span><span class="">cut</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8896;f. CutFormula f &#8712; set loc&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">and</span></span><span class=""> </span><span class="string">&quot;loc &#8866;d ( &#8896;<span class="hidden">&#8681;</span><sub>F</sub> l&#39; )<span class="hidden">&#8681;</span><sub>S</sub> &#8866;<span class="hidden">&#8681;</span><sub>S</sub> X&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">shows</span></span><span class=""> </span><span class="string">&quot;&#8896; l. set l&#39; &#8838; set l &#10233; loc &#8866;d ( &#8896;<span class="hidden">&#8681;</span><sub>F</sub> l )<span class="hidden">&#8681;</span><sub>S</sub> &#8866;<span class="hidden">&#8681;</span><sub>S</sub> X&quot;</span><span class="">
</span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">assms</span><span class="delimiter">(</span><span class="">2</span><span class="delimiter">)</span><span class=""> </span><span class="keyword1"><span class="command">proof</span></span><span class=""> </span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">l&#39;</span><span class="delimiter">)</span><span class="">
</span><span class="keyword3"><span class="command">case</span></span><span class=""> </span><span class="">Nil</span><span class=""> 
</span><span class="">  </span><span class="keyword1"><span class="command">have</span></span><span class=""> </span><span class="">1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(&#8896;<span class="hidden">&#8681;</span><sub>F</sub> []) = &#8868;<span class="hidden">&#8681;</span><sub>F</sub>&quot;</span><span class=""> </span><span class="keyword1"><span class="command">unfolding</span></span><span class=""> </span><span class="">conj_def</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">with</span></span><span class=""> </span><span class="">Nil</span><span class=""> </span><span class="keyword1"><span class="command">have</span></span><span class=""> </span><span class="string">&quot;loc &#8866;d &#8868;<span class="hidden">&#8681;</span><sub>F</sub> <span class="hidden">&#8681;</span><sub>S</sub> &#8866;<span class="hidden">&#8681;</span><sub>S</sub> X&quot;</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">then</span></span><span class=""> </span><span class="keyword1"><span class="command">have</span></span><span class=""> </span><span class="string">&quot;loc &#8866;d I<span class="hidden">&#8681;</span><sub>S</sub> &#8866;<span class="hidden">&#8681;</span><sub>S</sub> X&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">f</span><span class="delimiter">=</span><span class="string">&quot;&#8868;<span class="hidden">&#8681;</span><sub>F</sub>&quot;</span><span class=""> </span><span class="keyword2"><span class="keyword">in</span></span><span class=""> </span><span class="">derivable.SingleCut</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">cut</span><span class=""> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Top_R</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword3"><span class="command">thus</span></span><span class=""> </span><span class="var">?case</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.IW_L</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command">next</span></span><span class="">
</span><span class="keyword3"><span class="command">case</span></span><span class=""> </span><span class="delimiter">(</span><span class="">Cons</span><span class=""> </span><span class="">x</span><span class=""> </span><span class="">xs</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword3"><span class="command">show</span></span><span class=""> </span><span class="var">?case</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">f</span><span class="delimiter">=</span><span class="string">&quot;(&#8896;<span class="hidden">&#8681;</span><sub>F</sub> (x#xs))&quot;</span><span class=""> </span><span class="keyword2"><span class="keyword">in</span></span><span class=""> </span><span class="">derivable.SingleCut</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">cut</span><span class=""> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">conj_der2_aux</span><span class=""> </span><span class="">cut</span><span class=""> </span><span class="">Cons.prems</span><span class="delimiter">(</span><span class="">1</span><span class="delimiter">)</span><span class=""> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">Cons</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command">qed</span></span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">conj_der2b</span><span class="delimiter">:</span><span class=""> 
</span><span class="">  </span><span class="keyword2"><span class="keyword">fixes</span></span><span class=""> </span><span class="">l&#39;</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">assumes</span></span><span class=""> </span><span class="">cut</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8896;f. CutFormula f &#8712; set loc&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">and</span></span><span class=""> </span><span class="string">&quot;loc &#8866;d X &#8866;<span class="hidden">&#8681;</span><sub>S</sub> ( &#8896;<span class="hidden">&#8681;</span><sub>F</sub> l )<span class="hidden">&#8681;</span><sub>S</sub>&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">shows</span></span><span class=""> </span><span class="string">&quot;&#8896; l&#39;. set l&#39; &#8838; set l &#10233; loc &#8866;d X &#8866;<span class="hidden">&#8681;</span><sub>S</sub> ( &#8896;<span class="hidden">&#8681;</span><sub>F</sub> l&#39; )<span class="hidden">&#8681;</span><sub>S</sub>&quot;</span><span class="">
</span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">assms</span><span class="delimiter">(</span><span class="">2</span><span class="delimiter">)</span><span class=""> 
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">l</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">f</span><span class="delimiter">=</span><span class="string">&quot;(&#8896;<span class="hidden">&#8681;</span><sub>F</sub> a # l)&quot;</span><span class=""> </span><span class="keyword2"><span class="keyword">in</span></span><span class=""> </span><span class="">derivable.SingleCut</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">cut</span><span class=""> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">conj_der2_aux</span><span class=""> </span><span class="">cut</span><span class=""> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">conj_box_distrib</span><span class=""> </span><span class="delimiter">:</span><span class=""> 
</span><span class="">  </span><span class="keyword2"><span class="keyword">assumes</span></span><span class=""> </span><span class="">cut</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8896;f. CutFormula f &#8712; set loc&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">shows</span></span><span class=""> </span><span class="string">&quot;loc &#8866;d ( &#8896;<span class="hidden">&#8681;</span><sub>F</sub> map (Formula_FboxK (nat_to_string i)) l )<span class="hidden">&#8681;</span><sub>S</sub> &#8866;<span class="hidden">&#8681;</span><sub>S</sub> fboxK<span class="hidden">&#8681;</span><sub>F</sub> (nat_to_string i) ( &#8896;<span class="hidden">&#8681;</span><sub>F</sub> l )<span class="hidden">&#8681;</span><sub>S</sub>&quot;</span><span class=""> 
</span><span class="keyword1"><span class="command">proof</span></span><span class=""> </span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">l</span><span class="delimiter">)</span><span class="">
</span><span class="keyword3"><span class="command">case</span></span><span class=""> </span><span class="">Nil</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">have</span></span><span class=""> </span><span class="">1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;map (Formula_FboxK (nat_to_string i)) [] = []&quot;</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">have</span></span><span class=""> </span><span class="">2</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;foldr op &#8743;<span class="hidden">&#8681;</span><sub>F</sub> [] &#8868;<span class="hidden">&#8681;</span><sub>F</sub> = &#8868;<span class="hidden">&#8681;</span><sub>F</sub>&quot;</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword3"><span class="command">thus</span></span><span class=""> </span><span class="var">?case</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">unfolding</span></span><span class=""> </span><span class="">conj_def</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">unfolding</span></span><span class=""> </span><span class="">1</span><span class=""> </span><span class="">2</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.FboxK_R</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Back_forw_K2</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.IW_L</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Top_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command">next</span></span><span class="">
</span><span class="keyword3"><span class="command">case</span></span><span class=""> </span><span class="delimiter">(</span><span class="">Cons</span><span class=""> </span><span class="">x</span><span class=""> </span><span class="">xs</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">have</span></span><span class=""> </span><span class="">1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;map (Formula_FboxK (nat_to_string i)) (x # xs) = (fboxK<span class="hidden">&#8681;</span><sub>F</sub> nat_to_string i x) # (map (Formula_FboxK (nat_to_string i)) xs)&quot;</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword3"><span class="command">show</span></span><span class=""> </span><span class="var">?case</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">subst</span><span class=""> </span><span class="">conj_unfold_1</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">unfolding</span></span><span class=""> </span><span class="">1</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">subst</span><span class=""> </span><span class="">conj_unfold_1</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.FboxK_R</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_L</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Back_forw_K2</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.K_mon_L</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_R</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Back_forw_K</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">f</span><span class="delimiter">=</span><span class="string">&quot;fboxK<span class="hidden">&#8681;</span><sub>F</sub> nat_to_string i (&#8896;<span class="hidden">&#8681;</span><sub>F</sub> xs)&quot;</span><span class=""> </span><span class="keyword2"><span class="keyword">in</span></span><span class=""> </span><span class="">derivable.SingleCut</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">cut</span><span class=""> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">Cons</span><span class=""> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.FboxK_L</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">Id</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Back_forw_K</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.FboxK_L</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">Id</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command">qed</span></span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">conj_All</span><span class="delimiter">:</span><span class=""> 
</span><span class=""> </span><span class="keyword2"><span class="keyword">shows</span></span><span class=""> </span><span class="string">&quot;(&#8896;x. x &#8712; set List &#10233; (loc &#8866;d X &#8866;<span class="hidden">&#8681;</span><sub>S</sub> (x <span class="hidden">&#8681;</span><sub>S</sub>))) &#10233; loc &#8866;d X &#8866;<span class="hidden">&#8681;</span><sub>S</sub> (&#8896;<span class="hidden">&#8681;</span><sub>F</sub> List)<span class="hidden">&#8681;</span><sub>S</sub>&quot;</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">List</span><span class=""> </span><span class="">arbitrary</span><span class="delimiter">:</span><span class="">X</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">subst</span><span class=""> </span><span class="">conj_def</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class=""> 
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.IW_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Top_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">subst</span><span class=""> </span><span class="">conj_unfold_1</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.C_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">simp</span><span class="delimiter">+</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">conj_FboxK_distrib</span><span class=""> </span><span class="delimiter">:</span><span class=""> 
</span><span class="">  </span><span class="keyword2"><span class="keyword">assumes</span></span><span class=""> </span><span class="">cut</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8896;f. CutFormula f &#8712; set loc&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">shows</span></span><span class=""> </span><span class="string">&quot;loc &#8866;d (&#8896;<span class="hidden">&#8681;</span><sub>F</sub> (map (Formula_FboxK aa) list))<span class="hidden">&#8681;</span><sub>S</sub> &#8866;<span class="hidden">&#8681;</span><sub>S</sub> (fboxK<span class="hidden">&#8681;</span><sub>F</sub> aa (&#8896;<span class="hidden">&#8681;</span><sub>F</sub> list))<span class="hidden">&#8681;</span><sub>S</sub>&quot;</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">list</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">subst</span><span class=""> </span><span class="">conj_def</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.FboxK_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Back_forw_K2</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.IW_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Top_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command">proof</span></span><span class=""> </span><span class="">-</span><span class="">
</span><span class="keyword3"><span class="command">case</span></span><span class=""> </span><span class="">goal1</span><span class=""> 
</span><span class="">  </span><span class="keyword1"><span class="command">have</span></span><span class=""> </span><span class="">conj_unfold_map</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(&#8896;<span class="hidden">&#8681;</span><sub>F</sub> map (Formula_FboxK aa) (a # list)) = (fboxK<span class="hidden">&#8681;</span><sub>F</sub> aa a) &#8743;<span class="hidden">&#8681;</span><sub>F</sub> (&#8896;<span class="hidden">&#8681;</span><sub>F</sub> (map (Formula_FboxK aa) list))&quot;</span><span class=""> </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">conj_unfold_1</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">  </span><span class="keyword3"><span class="command">show</span></span><span class=""> </span><span class="var">?case</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">subst</span><span class=""> </span><span class="">conj_unfold_1</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">subst</span><span class=""> </span><span class="">conj_unfold_map</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_L</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.FboxK_R</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Back_forw_K2</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.K_mon_L</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_R</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Back_forw_K</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">f</span><span class="delimiter">=</span><span class="string">&quot;fboxK<span class="hidden">&#8681;</span><sub>F</sub> aa (&#8896;<span class="hidden">&#8681;</span><sub>F</sub> list)&quot;</span><span class=""> </span><span class="keyword2"><span class="keyword">in</span></span><span class=""> </span><span class="">derivable.SingleCut</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">cut</span><span class=""> </span><span class="">goal1</span><span class=""> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.FboxK_L</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">Id</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">Back_forw_K</span><span class=""> </span><span class="">FboxK_L</span><span class=""> </span><span class="">Id</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command">qed</span></span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">disj_lub</span><span class=""> </span><span class="delimiter">:</span><span class=""> 
</span><span class="">  </span><span class="keyword2"><span class="keyword">assumes</span></span><span class=""> </span><span class="">cut</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8896;f. CutFormula f &#8712; set loc&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">shows</span></span><span class=""> </span><span class="string">&quot;loc &#8866;d ( &#8896;<span class="hidden">&#8681;</span><sub>F</sub> map (&#955;B. B &#8594;<span class="hidden">&#8681;</span><sub>F</sub> A) list )<span class="hidden">&#8681;</span><sub>S</sub> &#8866;<span class="hidden">&#8681;</span><sub>S</sub> ((&#8897;<span class="hidden">&#8681;</span><sub>F</sub> list)<span class="hidden">&#8681;</span><sub>S</sub>) &#8594;<span class="hidden">&#8681;</span><sub>S</sub> (A <span class="hidden">&#8681;</span><sub>S</sub>)&quot;</span><span class=""> 
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">list</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">subst</span><span class=""> </span><span class="">conj_def</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">subst</span><span class=""> </span><span class="">disj_def</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.W_impR_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.IW_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Bot_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">subst</span><span class=""> </span><span class="">conj_unfold_1a</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">subst</span><span class=""> </span><span class="">disj_unfold_1</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impR_disp</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.E_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impR_disp2</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.C_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Or_L</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impR_disp</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impL_disp2</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impL_disp2</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.W_impL_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impL_disp</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.E_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impR_disp2</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impR_disp</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impL_disp2</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impR_disp2</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.W_impR_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impL_disp</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.E_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impR_disp2</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.ImpR_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">Id</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">Id</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">fun</span></span><span class=""> </span><span class="">k_apply</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;(&#39;a &#8658; &#39;a) &#8658; nat &#8658; &#39;a &#8658; &#39;a&quot;</span><span class=""> </span><span class="delimiter">(</span><span class="string">&quot;_ <span class="hidden">&#8679;</span><sup>_</sup> _&quot;</span><span class="delimiter">)</span><span class=""> </span><span class="keyword2"><span class="keyword">where</span></span><span class=""> 
</span><span class="string">&quot;k_apply Fun 0 f = f&quot;</span><span class=""> </span><span class="delimiter">|</span><span class="">
</span><span class="string">&quot;k_apply Fun (Suc x) f = Fun (k_apply Fun x f)&quot;</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">k_apply_unfold_bis</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;k_apply Fun (Suc k) f = k_apply Fun k (Fun f) &quot;</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">induction</span><span class=""> </span><span class="">k</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command">unfolding</span></span><span class=""> </span><span class="">k_apply.simps</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">simp</span><span class="delimiter">+</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">k_apply_S_Formula_FboxA_Structure_ForwA</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">fixes</span></span><span class=""> </span><span class="">loc</span><span class=""> 
</span><span class="">  </span><span class="keyword2"><span class="keyword">shows</span></span><span class=""> </span><span class="string">&quot;loc &#8866;d (k_apply (Formula_FboxA a) k form)<span class="hidden">&#8681;</span><sub>S</sub> &#8866;<span class="hidden">&#8681;</span><sub>S</sub> k_apply (Structure_ForwA a) k (form <span class="hidden">&#8681;</span><sub>S</sub>) &quot;</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">induction</span><span class=""> </span><span class="">k</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">Id</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command">unfolding</span></span><span class=""> </span><span class="">k_apply.simps</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.FboxA_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">k_apply_S_display_1</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">fixes</span></span><span class=""> </span><span class="">loc</span><span class=""> 
</span><span class="">  </span><span class="keyword2"><span class="keyword">assumes</span></span><span class=""> </span><span class="">cut</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8896;f. CutFormula f &#8712; set loc&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">shows</span></span><span class=""> </span><span class="string">&quot;loc &#8866;d X &#8866;<span class="hidden">&#8681;</span><sub>S</sub> (k_apply (Formula_FboxA a) k form)<span class="hidden">&#8681;</span><sub>S</sub> &#10231; loc &#8866;d X &#8866;<span class="hidden">&#8681;</span><sub>S</sub> k_apply (Structure_ForwA a) k (form <span class="hidden">&#8681;</span><sub>S</sub>) &quot;</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">rule</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">induction</span><span class=""> </span><span class="">k</span><span class=""> </span><span class="">arbitrary</span><span class="delimiter">:</span><span class=""> </span><span class="">X</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command">unfolding</span></span><span class=""> </span><span class="">k_apply.simps</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">f</span><span class="delimiter">=</span><span class="string">&quot;fboxA<span class="hidden">&#8681;</span><sub>F</sub> a Formula_FboxA a <span class="hidden">&#8679;</span><sup>k</sup> form&quot;</span><span class=""> </span><span class="keyword2"><span class="keyword">in</span></span><span class=""> </span><span class="">derivable.SingleCut</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">cut</span><span class=""> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">k_apply_S_Formula_FboxA_Structure_ForwA</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">k_apply_S_Formula_FboxA_Structure_ForwA</span><span class=""> </span><span class="">FboxA_L</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">k</span><span class=""> </span><span class="">arbitrary</span><span class="delimiter">:</span><span class=""> </span><span class="">X</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command">unfolding</span></span><span class=""> </span><span class="">k_apply.simps</span><span class="">
</span><span class="keyword1"><span class="command">proof</span></span><span class=""> </span><span class="">-</span><span class="">
</span><span class="keyword3"><span class="command">case</span></span><span class=""> </span><span class="">goal1</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">have</span></span><span class=""> </span><span class="">assms</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;loc &#8866;d backA<span class="hidden">&#8681;</span><sub>S</sub> a X &#8866;<span class="hidden">&#8681;</span><sub>S</sub> Structure_ForwA a <span class="hidden">&#8679;</span><sup>k</sup> form <span class="hidden">&#8681;</span><sub>S</sub>&quot;</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">Back_forw_A</span><span class=""> </span><span class="">goal1</span><span class="delimiter">(</span><span class="">1</span><span class="delimiter">)</span><span class=""> </span><span class="">goal1</span><span class="delimiter">(</span><span class="">2</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword3"><span class="command">thus</span></span><span class=""> </span><span class="var">?case</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.FboxA_R</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Back_forw_A2</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">goal1</span><span class="delimiter">(</span><span class="">1</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command">qed</span></span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">k_apply_S_display_1a</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">fixes</span></span><span class=""> </span><span class="">loc</span><span class=""> 
</span><span class="">  </span><span class="keyword2"><span class="keyword">assumes</span></span><span class=""> </span><span class="">cut</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8896;f. CutFormula f &#8712; set loc&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">shows</span></span><span class=""> </span><span class="string">&quot;loc &#8866;d X &#8866;<span class="hidden">&#8681;</span><sub>S</sub> (k_apply (Formula_FboxA a) k form)<span class="hidden">&#8681;</span><sub>S</sub> &#10233; loc &#8866;d X &#8866;<span class="hidden">&#8681;</span><sub>S</sub> k_apply (Structure_ForwA a) k (form <span class="hidden">&#8681;</span><sub>S</sub>) &quot;</span><span class="">
</span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">k_apply_S_display_1</span><span class=""> </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">cut</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">k_apply_S_display_1b</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">fixes</span></span><span class=""> </span><span class="">loc</span><span class=""> 
</span><span class="">  </span><span class="keyword2"><span class="keyword">assumes</span></span><span class=""> </span><span class="">cut</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8896;f. CutFormula f &#8712; set loc&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">shows</span></span><span class=""> </span><span class="string">&quot;loc &#8866;d X &#8866;<span class="hidden">&#8681;</span><sub>S</sub> k_apply (Structure_ForwA a) k (form <span class="hidden">&#8681;</span><sub>S</sub>) &#10233; loc &#8866;d X &#8866;<span class="hidden">&#8681;</span><sub>S</sub> (k_apply (Formula_FboxA a) k form)<span class="hidden">&#8681;</span><sub>S</sub>&quot;</span><span class="">
</span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">k_apply_S_display_1</span><span class=""> </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">cut</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">k_apply_S_display_1diam</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">fixes</span></span><span class=""> </span><span class="">loc</span><span class=""> 
</span><span class="">  </span><span class="keyword2"><span class="keyword">shows</span></span><span class=""> </span><span class="string">&quot;loc &#8866;d (Structure_ForwA a) <span class="hidden">&#8679;</span><sup>k</sup> (form <span class="hidden">&#8681;</span><sub>S</sub>) &#8866;<span class="hidden">&#8681;</span><sub>S</sub> X &#10233; loc &#8866;d ((Formula_FdiamA a) <span class="hidden">&#8679;</span><sup>k</sup> form)<span class="hidden">&#8681;</span><sub>S</sub> &#8866;<span class="hidden">&#8681;</span><sub>S</sub> X&quot;</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">k</span><span class=""> </span><span class="">arbitrary</span><span class="delimiter">:</span><span class="">X</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command">unfolding</span></span><span class=""> </span><span class="">k_apply.simps</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command">proof</span></span><span class=""> </span><span class="">-</span><span class="">
</span><span class="keyword3"><span class="command">case</span></span><span class=""> </span><span class="">goal1</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">then</span></span><span class=""> </span><span class="keyword1"><span class="command">have</span></span><span class=""> </span><span class="string">&quot;loc &#8866;d Structure_ForwA a <span class="hidden">&#8679;</span><sup>k</sup> form <span class="hidden">&#8681;</span><sub>S</sub> &#8866;<span class="hidden">&#8681;</span><sub>S</sub> backA<span class="hidden">&#8681;</span><sub>S</sub> a X&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Forw_back_A</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class=""> 
</span><span class="">  </span><span class="keyword1"><span class="command">with</span></span><span class=""> </span><span class="">goal1</span><span class=""> </span><span class="keyword1"><span class="command">have</span></span><span class=""> </span><span class="string">&quot;loc &#8866;d Formula_FdiamA a <span class="hidden">&#8679;</span><sup>k</sup> form <span class="hidden">&#8681;</span><sub>S</sub> &#8866;<span class="hidden">&#8681;</span><sub>S</sub> backA<span class="hidden">&#8681;</span><sub>S</sub> a X&quot;</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword3"><span class="command">thus</span></span><span class=""> </span><span class="var">?case</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.FdiamA_L</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Forw_back_A2</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command">qed</span></span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">k_apply_S_F_forw_diam</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">fixes</span></span><span class=""> </span><span class="">loc</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">shows</span></span><span class=""> </span><span class="string">&quot;loc &#8866;d  X <span class="hidden">&#8681;</span><sub>S</sub> &#8866;<span class="hidden">&#8681;</span><sub>S</sub> Y <span class="hidden">&#8681;</span><sub>S</sub> &#10233; loc &#8866;d Structure_ForwA a <span class="hidden">&#8679;</span><sup>k</sup> X <span class="hidden">&#8681;</span><sub>S</sub> &#8866;<span class="hidden">&#8681;</span><sub>S</sub> Formula_FdiamA a <span class="hidden">&#8679;</span><sup>k</sup> Y <span class="hidden">&#8681;</span><sub>S</sub>&quot;</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">k</span><span class=""> </span><span class="">arbitrary</span><span class="delimiter">:</span><span class="">X</span><span class=""> </span><span class="">Y</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.FdiamA_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">k_apply_S_display_2</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">fixes</span></span><span class=""> </span><span class="">loc</span><span class=""> 
</span><span class="">  </span><span class="keyword2"><span class="keyword">shows</span></span><span class=""> </span><span class="string">&quot;loc &#8866;d X &#8866;<span class="hidden">&#8681;</span><sub>S</sub> k_apply (Structure_ForwA a) k Y &#10231; loc &#8866;d k_apply (Structure_BackA a) k X &#8866;<span class="hidden">&#8681;</span><sub>S</sub> Y&quot;</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">rule</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">k</span><span class=""> </span><span class="">arbitrary</span><span class="delimiter">:</span><span class=""> </span><span class="">X</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">Back_forw_A</span><span class=""> </span><span class="">k_apply.simps</span><span class="delimiter">(</span><span class="">2</span><span class="delimiter">)</span><span class=""> </span><span class="">k_apply_unfold_bis</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">k</span><span class=""> </span><span class="">arbitrary</span><span class="delimiter">:</span><span class=""> </span><span class="">X</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">Back_forw_A2</span><span class=""> </span><span class="">k_apply.simps</span><span class="delimiter">(</span><span class="">2</span><span class="delimiter">)</span><span class=""> </span><span class="">k_apply_unfold_bis</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">k_apply_S_display_2a</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">fixes</span></span><span class=""> </span><span class="">loc</span><span class=""> 
</span><span class="">  </span><span class="keyword2"><span class="keyword">shows</span></span><span class=""> </span><span class="string">&quot;loc &#8866;d X &#8866;<span class="hidden">&#8681;</span><sub>S</sub> k_apply (Structure_ForwA a) k Y &#10233; loc &#8866;d k_apply (Structure_BackA a) k X &#8866;<span class="hidden">&#8681;</span><sub>S</sub> Y&quot;</span><span class="">
</span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">k_apply_S_display_2</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">k_apply_S_display_2b</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">fixes</span></span><span class=""> </span><span class="">loc</span><span class=""> 
</span><span class="">  </span><span class="keyword2"><span class="keyword">shows</span></span><span class=""> </span><span class="string">&quot;loc &#8866;d k_apply (Structure_BackA a) k X &#8866;<span class="hidden">&#8681;</span><sub>S</sub> Y &#10233; loc &#8866;d X &#8866;<span class="hidden">&#8681;</span><sub>S</sub> k_apply (Structure_ForwA a) k Y&quot;</span><span class="">
</span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">k_apply_S_display_2</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">k_apply_S_display_2back</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">fixes</span></span><span class=""> </span><span class="">loc</span><span class=""> 
</span><span class="">  </span><span class="keyword2"><span class="keyword">shows</span></span><span class=""> </span><span class="string">&quot;loc &#8866;d k_apply (Structure_BackA a) k X &#8866;<span class="hidden">&#8681;</span><sub>S</sub> Y &#10231; loc &#8866;d X &#8866;<span class="hidden">&#8681;</span><sub>S</sub> k_apply (Structure_ForwA a) k Y&quot;</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">rule</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">k</span><span class=""> </span><span class="">arbitrary</span><span class="delimiter">:</span><span class=""> </span><span class="">X</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">k_apply_S_display_2</span><span class=""> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">k</span><span class=""> </span><span class="">arbitrary</span><span class="delimiter">:</span><span class=""> </span><span class="">X</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">k_apply_S_display_2</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">k_apply_elim_diamA</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">fixes</span></span><span class=""> </span><span class="">loc</span><span class=""> 
</span><span class="">  </span><span class="keyword2"><span class="keyword">shows</span></span><span class=""> </span><span class="string">&quot;loc &#8866;d forma <span class="hidden">&#8681;</span><sub>S</sub> &#8866;<span class="hidden">&#8681;</span><sub>S</sub> formb <span class="hidden">&#8681;</span><sub>S</sub> &#10233; loc &#8866;d (k_apply (Formula_FdiamA a) k forma)<span class="hidden">&#8681;</span><sub>S</sub> &#8866;<span class="hidden">&#8681;</span><sub>S</sub> (k_apply (Formula_FdiamA a) k formb)<span class="hidden">&#8681;</span><sub>S</sub> &quot;</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">k</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">FdiamA_L</span><span class=""> </span><span class="">FdiamA_R</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">k_apply_DiamBot</span><span class="delimiter">:</span><span class=""> 
</span><span class="">  </span><span class="keyword2"><span class="keyword">fixes</span></span><span class=""> </span><span class="">loc</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">shows</span></span><span class=""> </span><span class="string">&quot;loc &#8866;d ( k_apply ( Formula_FdiamA A ) k &#8869;<span class="hidden">&#8681;</span><sub>F</sub> ) <span class="hidden">&#8681;</span><sub>S</sub> &#8866;<span class="hidden">&#8681;</span><sub>S</sub> I<span class="hidden">&#8681;</span><sub>S</sub> &quot;</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">k</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command">unfolding</span></span><span class=""> </span><span class="">k_apply.simps</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Bot_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.FdiamA_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Forw_back_A2</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.A_nec_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">k_apply_DiamBot_Is</span><span class="delimiter">:</span><span class=""> 
</span><span class="">  </span><span class="keyword2"><span class="keyword">fixes</span></span><span class=""> </span><span class="">loc</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">shows</span></span><span class=""> </span><span class="string">&quot;loc &#8866;d ( k_apply ( Formula_FdiamA A ) k &#8869;<span class="hidden">&#8681;</span><sub>F</sub> ) <span class="hidden">&#8681;</span><sub>S</sub> &#8866;<span class="hidden">&#8681;</span><sub>S</sub> I<span class="hidden">&#8681;</span><sub>S</sub>&quot;</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">k</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command">unfolding</span></span><span class=""> </span><span class="">k_apply.simps</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Bot_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.FdiamA_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Forw_back_A2</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.A_nec_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">k_apply_BoxDiam</span><span class="delimiter">:</span><span class=""> 
</span><span class="">  </span><span class="keyword2"><span class="keyword">fixes</span></span><span class=""> </span><span class="">loc</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">assumes</span></span><span class=""> </span><span class="">cut</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8896;f. CutFormula f &#8712; set loc&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">shows</span></span><span class=""> </span><span class="string">&quot;loc &#8866;d ( k_apply ( Formula_FboxA A ) k p ) &#8743;<span class="hidden">&#8681;</span><sub>F</sub> ( k_apply ( Formula_FdiamA A ) k q) <span class="hidden">&#8681;</span><sub>S</sub> &#8866;<span class="hidden">&#8681;</span><sub>S</sub> ( k_apply ( Formula_FdiamA A ) k ( p&#8743;<span class="hidden">&#8681;</span><sub>F</sub>q ) ) <span class="hidden">&#8681;</span><sub>S</sub> &quot;</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">k</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">Id</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">subst</span><span class=""> </span><span class="">k_apply.simps</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">f</span><span class="delimiter">=</span><span class="string">&quot;Formula_FdiamA A ( ((Formula_FboxA A) <span class="hidden">&#8679;</span><sup>k</sup> p )&#8743;<span class="hidden">&#8681;</span><sub>F</sub> ((Formula_FdiamA A) <span class="hidden">&#8679;</span><sup>k</sup> q))&quot;</span><span class=""> </span><span class="keyword2"><span class="keyword">in</span></span><span class=""> </span><span class="">derivable.SingleCut</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">cut</span><span class=""> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impR_disp2</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.FdiamA_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Forw_back_A2</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.A_FS_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impR_disp</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Forw_back_A</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.FdiamA_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.And_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">defer</span></span></span></span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Back_forw_A</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.FboxA_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">Id</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">defer</span></span></span></span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">Id</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.FdiamA_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.FdiamA_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">k_apply_S_FS</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">fixes</span></span><span class=""> </span><span class="">loc</span><span class=""> 
</span><span class="">  </span><span class="keyword2"><span class="keyword">shows</span></span><span class=""> </span><span class="string">&quot;loc &#8866;d X &#8866;<span class="hidden">&#8681;</span><sub>S</sub> (k_apply (Structure_ForwA a) k Y) &#8594;<span class="hidden">&#8681;</span><sub>S</sub> (k_apply (Structure_ForwA a) k Z) &#10233; loc &#8866;d X &#8866;<span class="hidden">&#8681;</span><sub>S</sub> k_apply (Structure_ForwA a) k (Y &#8594;<span class="hidden">&#8681;</span><sub>S</sub> Z)&quot;</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">k</span><span class=""> </span><span class="">arbitrary</span><span class="delimiter">:</span><span class=""> </span><span class="">X</span><span class=""> </span><span class="">Y</span><span class=""> </span><span class="">Z</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">Back_forw_A</span><span class=""> </span><span class="">Back_forw_A2</span><span class=""> </span><span class="">FS_A_R</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">k_apply_S_Atom</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">fixes</span></span><span class=""> </span><span class="">loc</span><span class=""> 
</span><span class="">  </span><span class="keyword2"><span class="keyword">assumes</span></span><span class=""> </span><span class="">cut</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8896;f. CutFormula f &#8712; set loc&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">shows</span></span><span class=""> </span><span class="string">&quot;loc &#8866;d X <span class="hidden">&#8681;</span><sub>F</sub> <span class="hidden">&#8681;</span><sub>S</sub> &#8866;<span class="hidden">&#8681;</span><sub>S</sub> forwA<span class="hidden">&#8681;</span><sub>S</sub> b (k_apply (Structure_ForwA a) k (X <span class="hidden">&#8681;</span><sub>F</sub> <span class="hidden">&#8681;</span><sub>S</sub>))&quot;</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">f</span><span class="delimiter">=</span><span class="string">&quot;fboxA<span class="hidden">&#8681;</span><sub>F</sub> b (X <span class="hidden">&#8681;</span><sub>F</sub>)&quot;</span><span class=""> </span><span class="keyword2"><span class="keyword">in</span></span><span class=""> </span><span class="">derivable.SingleCut</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">cut</span><span class=""> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.FboxA_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Atom</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.FboxA_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">k</span><span class=""> </span><span class="">arbitrary</span><span class="delimiter">:</span><span class=""> </span><span class="">X</span><span class=""> </span><span class="">a</span><span class=""> </span><span class="">b</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">Atom</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="delimiter">+</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Back_forw_A2</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">f</span><span class="delimiter">=</span><span class="string">&quot;X <span class="hidden">&#8681;</span><sub>F</sub>&quot;</span><span class=""> </span><span class="keyword2"><span class="keyword">in</span></span><span class=""> </span><span class="">derivable.SingleCut</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">cut</span><span class=""> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">Atom</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">simp</span><span class="delimiter">+</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">k_apply_F_FboxA</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">fixes</span></span><span class=""> </span><span class="">loc</span><span class=""> 
</span><span class="">  </span><span class="keyword2"><span class="keyword">shows</span></span><span class=""> </span><span class="string">&quot;loc &#8866;d X <span class="hidden">&#8681;</span><sub>S</sub> &#8866;<span class="hidden">&#8681;</span><sub>S</sub> (Formula_FboxA a X) <span class="hidden">&#8681;</span><sub>S</sub> &#10233; loc &#8866;d (k_apply (Formula_FboxA a) k X) <span class="hidden">&#8681;</span><sub>S</sub> &#8866;<span class="hidden">&#8681;</span><sub>S</sub> (k_apply (Formula_FboxA a) (Suc k) X) <span class="hidden">&#8681;</span><sub>S</sub>&quot;</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">k</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command">unfolding</span></span><span class=""> </span><span class="">k_apply.simps</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.FboxA_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.FboxA_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">Swapout_R_1</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">fixes</span></span><span class=""> </span><span class="">loc</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">assumes</span></span><span class=""> </span><span class="string">&quot;RelAKA rel &#8712; set loc&quot;</span><span class=""> </span><span class="keyword2"><span class="keyword">and</span></span><span class=""> </span><span class="string">&quot;rel alpha a = [beta]&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">shows</span></span><span class=""> </span><span class="string">&quot;loc &#8866;d Y &#8866;<span class="hidden">&#8681;</span><sub>S</sub> forwK<span class="hidden">&#8681;</span><sub>S</sub> a forwA<span class="hidden">&#8681;</span><sub>S</sub> beta X &#10233; loc &#8866;d ;;<span class="hidden">&#8681;</span><sub>S</sub> [Y] &#8866;<span class="hidden">&#8681;</span><sub>S</sub> forwA<span class="hidden">&#8681;</span><sub>S</sub> alpha forwK<span class="hidden">&#8681;</span><sub>S</sub> a X&quot;</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">derivable.Swapout_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">assms</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">Bot_imp_all</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;loc &#8866;d &#8869;<span class="hidden">&#8681;</span><sub>F</sub> <span class="hidden">&#8681;</span><sub>S</sub> &#8866;<span class="hidden">&#8681;</span><sub>S</sub> X&quot;</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.IW_R</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Bot_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">Swapout_R_2aux</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">fixes</span></span><span class=""> </span><span class="">loc</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">assumes</span></span><span class=""> </span><span class="">refl_rel</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;RelAKA rel &#8712; set loc&quot;</span><span class=""> </span><span class="keyword2"><span class="keyword">and</span></span><span class=""> </span><span class="string">&quot;rel alpha a = [alpha]&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">shows</span></span><span class=""> </span><span class="string">&quot;loc &#8866;d Y  &#8866;<span class="hidden">&#8681;</span><sub>S</sub>  (Structure_ForwA alpha) <span class="hidden">&#8679;</span><sup>k</sup> (forwK<span class="hidden">&#8681;</span><sub>S</sub> a forwA<span class="hidden">&#8681;</span><sub>S</sub> alpha X)  &#10233; loc &#8866;d Y &#8866;<span class="hidden">&#8681;</span><sub>S</sub> Structure_ForwA alpha <span class="hidden">&#8679;</span><sup>(</sup>Suc k) (forwK<span class="hidden">&#8681;</span><sub>S</sub> a X)&quot;</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">k</span><span class=""> </span><span class="">arbitrary</span><span class="delimiter">:</span><span class=""> </span><span class="">X</span><span class=""> </span><span class="">Y</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.I_impR2</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Bigcomma_Nil_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impR_disp</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Bigcomma_Cons_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">rel</span><span class="delimiter">=</span><span class="">rel</span><span class=""> </span><span class="keyword2"><span class="keyword">and</span></span><span class=""> </span><span class="">beta</span><span class="delimiter">=</span><span class="">alpha</span><span class=""> </span><span class="keyword2"><span class="keyword">in</span></span><span class=""> </span><span class="">Swapout_R_1</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">assms</span><span class=""> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class="delimiter">,</span><span class="">simp</span><span class="delimiter">,</span><span class=""> </span><span class="">simp</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">k_apply_S_display_2b</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">subst</span><span class=""> </span><span class="">k_apply.simps</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Back_forw_A</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.I_impR2</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Bigcomma_Nil_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Comma_impR_disp</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">derivable.Bigcomma_Cons_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">rel</span><span class="delimiter">=</span><span class="">rel</span><span class=""> </span><span class="keyword2"><span class="keyword">and</span></span><span class=""> </span><span class="">beta</span><span class="delimiter">=</span><span class="">alpha</span><span class=""> </span><span class="keyword2"><span class="keyword">in</span></span><span class=""> </span><span class="">Swapout_R_1</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">assms</span><span class=""> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class="delimiter">,</span><span class="">simp</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">k_apply_S_display_2a</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">Swapout_R_2</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">fixes</span></span><span class=""> </span><span class="">loc</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">assumes</span></span><span class=""> </span><span class="">refl_rel</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;RelAKA rel &#8712; set loc&quot;</span><span class=""> </span><span class="keyword2"><span class="keyword">and</span></span><span class=""> </span><span class="string">&quot;rel alpha a = [alpha]&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">and</span></span><span class=""> </span><span class="">cut</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8896;f. CutFormula f &#8712; set loc&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">shows</span></span><span class=""> </span><span class="string">&quot;loc &#8866;d (fboxK<span class="hidden">&#8681;</span><sub>F</sub> a (Formula_FboxA alpha <span class="hidden">&#8679;</span><sup>k</sup> X))<span class="hidden">&#8681;</span><sub>S</sub>  &#8866;<span class="hidden">&#8681;</span><sub>S</sub> Structure_ForwA alpha <span class="hidden">&#8679;</span><sup>k</sup> (forwK<span class="hidden">&#8681;</span><sub>S</sub> a X <span class="hidden">&#8681;</span><sub>S</sub>)&quot;</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">k</span><span class=""> </span><span class="">arbitrary</span><span class="delimiter">:</span><span class=""> </span><span class="">X</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">subst</span><span class=""> </span><span class="">k_apply.simps</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">FboxK_L</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">Id</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command">proof</span></span><span class=""> </span><span class="">-</span><span class=""> 
</span><span class="keyword3"><span class="command">case</span></span><span class=""> </span><span class="">goal1</span><span class=""> 
</span><span class="">  </span><span class="keyword1"><span class="command">have</span></span><span class=""> </span><span class="">cut_f</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;loc &#8866;d Formula_FboxA alpha <span class="hidden">&#8679;</span><sup>k</sup> fboxK<span class="hidden">&#8681;</span><sub>F</sub> a fboxA<span class="hidden">&#8681;</span><sub>F</sub> alpha X <span class="hidden">&#8681;</span><sub>S</sub> &#8866;<span class="hidden">&#8681;</span><sub>S</sub> Structure_ForwA alpha <span class="hidden">&#8679;</span><sup>k</sup> forwK<span class="hidden">&#8681;</span><sub>S</sub> a forwA<span class="hidden">&#8681;</span><sub>S</sub> alpha X <span class="hidden">&#8681;</span><sub>S</sub>&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">k</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">subst</span><span class=""> </span><span class="">k_apply.simps</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">FboxK_L</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">FboxA_L</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">Id</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">subst</span><span class=""> </span><span class="">k_apply.simps</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">FboxA_L</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  
</span><span class="">  </span><span class="keyword1"><span class="command">have</span></span><span class=""> </span><span class="">subst1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;fboxA<span class="hidden">&#8681;</span><sub>F</sub> alpha Formula_FboxA alpha <span class="hidden">&#8679;</span><sup>k</sup> X = Formula_FboxA alpha <span class="hidden">&#8679;</span><sup>k</sup> fboxA<span class="hidden">&#8681;</span><sub>F</sub> alpha X&quot;</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">k_apply.simps</span><span class="delimiter">(</span><span class="">2</span><span class="delimiter">)</span><span class=""> </span><span class="">k_apply_unfold_bis</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword3"><span class="command">show</span></span><span class=""> </span><span class="var">?case</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">subst</span><span class=""> </span><span class="">k_apply.simps</span><span class="delimiter">)</span><span class="">
</span><span class="">  
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">Swapout_R_2aux</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">assms</span><span class=""> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class="delimiter">,</span><span class="">simp</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">subst</span><span class=""> </span><span class="">subst1</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">f</span><span class="delimiter">=</span><span class="string">&quot;Formula_FboxA alpha <span class="hidden">&#8679;</span><sup>k</sup> fboxK<span class="hidden">&#8681;</span><sub>F</sub> a fboxA<span class="hidden">&#8681;</span><sub>F</sub> alpha X&quot;</span><span class=""> </span><span class="keyword2"><span class="keyword">in</span></span><span class=""> </span><span class="">derivable.SingleCut</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">cut</span><span class=""> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">defer</span></span></span></span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">cut_f</span><span class=""> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">k_apply_S_display_1b</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">cut</span><span class=""> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">goal1</span><span class=""> </span><span class="">FboxK_R</span><span class=""> </span><span class="">k_apply_S_display_2back</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="keyword1"><span class="command">qed</span></span><span class="">
</span><span class="keyword2"><span class="keyword">end</span></span></pre>

</div>
</body>
</html>
