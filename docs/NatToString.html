<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>Theory NatToString (Isabelle2017: October 2017)</title>
<link media="all" rel="stylesheet" type="text/css" href="isabelle.css"/>
</head>

<body>
<div class="head"><h1>Theory NatToString</h1>

<span class="command">theory</span> <span class="name">NatToString</span><br/>
<span class="keyword">imports</span> <a href="../../HOL/HOL/Main.html"><span class="name">Main</span></a><br/>

</div>
<div class="source">
<pre class="source"><span class="keyword1"><span class="command">theory</span></span><span class=""> </span><span class="">NatToString</span><span class="">
</span><span class="keyword2"><span class="keyword">imports</span></span><span class=""> </span><span class="">Main</span><span class=""> 
</span><span class="keyword2"><span class="keyword">begin</span></span><span class="">
</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">definition</span></span><span class=""> </span><span class="">digit_char_list</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;string&quot;</span><span class=""> </span><span class="keyword2"><span class="keyword">where</span></span><span class="">
</span><span class="string">&quot;digit_char_list = &#39;&#39;0123456789&#39;&#39;&quot;</span><span class="">
</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">digit_char_list_length</span><span class="delimiter">[</span><span class="">simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">shows</span></span><span class=""> </span><span class="string">&quot;length digit_char_list = (10::nat)&quot;</span><span class="">
</span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">One_nat_def</span><span class=""> </span><span class="">Suc_eq_plus1</span><span class=""> </span><span class="">digit_char_list_def</span><span class=""> </span><span class="">eval_nat_numeral</span><span class="delimiter">(</span><span class="">2</span><span class="delimiter">)</span><span class=""> </span><span class="">eval_nat_numeral</span><span class="delimiter">(</span><span class="">3</span><span class="delimiter">)</span><span class=""> </span><span class="">list.size</span><span class="delimiter">(</span><span class="">3</span><span class="delimiter">)</span><span class=""> </span><span class="">list.size</span><span class="delimiter">(</span><span class="">4</span><span class="delimiter">)</span><span class=""> </span><span class="">nat_1_add_1</span><span class=""> </span><span class="">semiring_norm</span><span class="delimiter">(</span><span class="">26</span><span class="delimiter">)</span><span class=""> </span><span class="">semiring_norm</span><span class="delimiter">(</span><span class="">27</span><span class="delimiter">)</span><span class=""> </span><span class="">semiring_norm</span><span class="delimiter">(</span><span class="">28</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">digit_char_list_distinct</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">shows</span></span><span class=""> </span><span class="string">&quot;distinct digit_char_list&quot;</span><span class="">
</span><span class="keyword1"><span class="command">unfolding</span></span><span class=""> </span><span class="">digit_char_list_def</span><span class=""> </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">distinct.simps</span><span class="delimiter">(</span><span class="">2</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">fun</span></span><span class=""> </span><span class="">nat_to_string</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;nat &#8658; string&quot;</span><span class=""> </span><span class="delimiter">(</span><span class="string">&quot;`_`&quot;</span><span class="delimiter">)</span><span class="">
</span><span class="keyword2"><span class="keyword">where</span></span><span class="">
</span><span class="string">&quot;nat_to_string n = (if n &lt; (length digit_char_list) then [digit_char_list ! n] else 
nat_to_string (n div (length digit_char_list)) @ [digit_char_list ! (n mod (length digit_char_list))])&quot;</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">nEq_exE</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">fixes</span></span><span class=""> </span><span class="">s</span><span class=""> </span><span class="">s&#39;</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">shows</span></span><span class=""> </span><span class="string">&quot;(&#8707;e &#8712; s . e &#8713; s&#39;) &#8744; (&#8707;e &#8712; s&#39;. e &#8713; s) &#10233; (s::&#39;a set) &#8800; s&#39;&quot;</span><span class="">
</span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">digit_char_list_inject</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">fixes</span></span><span class=""> </span><span class="">i</span><span class=""> </span><span class="">j</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">defines</span></span><span class=""> </span><span class="string">&quot;list &#8801; digit_char_list&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">assumes</span></span><span class=""> </span><span class="string">&quot;i &#8800; j&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">and</span></span><span class=""> </span><span class="string">&quot;i &lt; length list&quot;</span><span class=""> </span><span class="string">&quot;j &lt; length list&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">shows</span></span><span class=""> </span><span class="string">&quot;set (filter (&#955;x. x &#8800; list ! i) list) &#8800; set (filter (&#955;x. x &#8800; list ! j) list)&quot;</span><span class="">
</span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">assms</span><span class="delimiter">(</span><span class="">2</span><span class="delimiter">,</span><span class="">3</span><span class="delimiter">,</span><span class="">4</span><span class="delimiter">)</span><span class=""> </span><span class="">digit_char_list_distinct</span><span class=""> </span><span class="keyword1"><span class="command">unfolding</span></span><span class=""> </span><span class="">list_def</span><span class=""> </span><span class="">digit_char_list_def</span><span class=""> 
</span><span class="keyword1"><span class="command">proof</span></span><span class=""> </span><span class="">goal_cases</span><span class="">
</span><span class="keyword3"><span class="command">case</span></span><span class=""> </span><span class="">1</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">then</span></span><span class=""> </span><span class="keyword1"><span class="command">have</span></span><span class=""> </span><span class="">assms2</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;i &#8804; 9&quot;</span><span class=""> </span><span class="string">&quot;j &#8804; 9&quot;</span><span class=""> </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">digit_char_list_length</span><span class=""> </span><span class="">assms</span><span class="delimiter">(</span><span class="">2</span><span class="delimiter">,</span><span class="">3</span><span class="delimiter">,</span><span class="">4</span><span class="delimiter">)</span><span class=""> </span><span class="">digit_char_list_distinct</span><span class=""> </span><span class="keyword1"><span class="command">unfolding</span></span><span class=""> </span><span class="">list_def</span><span class=""> </span><span class="">digit_char_list_def</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">simp</span><span class="delimiter">+</span><span class="">
</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">have</span></span><span class=""> </span><span class="">set_expand</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;{0..9::nat} = {0, 1, 2, 3, 4, 5, 6, 7, 8, 9}&quot;</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">have</span></span><span class=""> </span><span class="string">&quot;&#8704;ii &#8712; {0,1,2,3,4,5,6,7,8,9}::nat set. &#8704;jj &#8712; {0,1,2,3,4,5,6,7,8,9}::nat set. ii&#8800;jj &#10230; 
    set (filter (&#955;x. x &#8800; &#39;&#39;0123456789&#39;&#39; ! ii) &#39;&#39;0123456789&#39;&#39;) &#8800; 
    set (filter (&#955;x. x &#8800; &#39;&#39;0123456789&#39;&#39; ! jj) &#39;&#39;0123456789&#39;&#39;)&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">unfolding</span></span><span class=""> </span><span class="">digit_char_list_def</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">conjI</span><span class="delimiter">,</span><span class=""> </span><span class="">rule</span><span class=""> </span><span class="">nEq_exE</span><span class="delimiter">,</span><span class=""> </span><span class="">simp</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">nEq_exE</span><span class="delimiter">,</span><span class=""> </span><span class="">simp</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">then</span></span><span class=""> </span><span class="keyword1"><span class="command">have</span></span><span class=""> </span><span class="string">&quot;&#8704;ii &#8712; {0..9::nat}. &#8704;jj &#8712; {0..9::nat}. ii&#8800;jj &#10230; 
    set (filter (&#955;x. x &#8800; &#39;&#39;0123456789&#39;&#39; ! ii) &#39;&#39;0123456789&#39;&#39;) &#8800; 
    set (filter (&#955;x. x &#8800; &#39;&#39;0123456789&#39;&#39; ! jj) &#39;&#39;0123456789&#39;&#39;)&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">subst</span><span class=""> </span><span class="">set_expand</span><span class="delimiter">)</span><span class="delimiter">+</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">then</span></span><span class=""> </span><span class="keyword1"><span class="command">have</span></span><span class=""> </span><span class="">res</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8896;ii jj. ii &#8712; {0..9::nat} &#10233; jj &#8712; {0..9::nat} &#10233; ii&#8800;jj &#10233; set (filter (&#955;x. x &#8800; &#39;&#39;0123456789&#39;&#39; ! ii) &#39;&#39;0123456789&#39;&#39;) &#8800; set (filter (&#955;x. x &#8800; &#39;&#39;0123456789&#39;&#39; ! jj) &#39;&#39;0123456789&#39;&#39;)&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class=""> 
</span><span class="">  </span><span class="keyword1"><span class="command">with</span></span><span class=""> </span><span class="">assms</span><span class=""> </span><span class="keyword1"><span class="command">have</span></span><span class=""> </span><span class="string">&quot;i &#8712; {0..9::nat}&quot;</span><span class=""> </span><span class="string">&quot;i &#8713; -{0..9::nat}&quot;</span><span class=""> </span><span class="string">&quot;j &#8712; {0..9::nat}&quot;</span><span class=""> </span><span class="string">&quot;j &#8713; -{0..9::nat}&quot;</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">  </span><span class="keyword3"><span class="command">show</span></span><span class=""> </span><span class="var">?case</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">cases</span><span class=""> </span><span class="string">&quot;i &#8712; {0..9::nat}&quot;</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">cases</span><span class=""> </span><span class="string">&quot;j &#8712; {0..9::nat}&quot;</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">res</span><span class=""> </span><span class="">assms</span><span class="delimiter">(</span><span class="">2</span><span class="delimiter">)</span><span class=""> </span><span class="">set_expand</span><span class=""> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">assms</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">simp</span><span class="delimiter">+</span><span class="">
</span><span class="keyword1"><span class="command">qed</span></span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">digit_char_list_inject2</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">fixes</span></span><span class=""> </span><span class="">i</span><span class=""> </span><span class="">j</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="">nat</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">assumes</span></span><span class=""> </span><span class="string">&quot;digit_char_list ! (i mod 10) = digit_char_list ! (j mod 10)&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">shows</span></span><span class=""> </span><span class="string">&quot;(i mod 10) = (j mod 10)&quot;</span><span class="">
</span><span class="keyword1"><span class="command">proof</span></span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">have</span></span><span class=""> </span><span class="string">&quot;i mod 10 &lt; 10&quot;</span><span class=""> </span><span class="string">&quot;j mod 10 &lt; 10&quot;</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">simp</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword3"><span class="command">thus</span></span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">digit_char_list_inject</span><span class=""> </span><span class="">assms</span><span class="">  </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">fastforce</span><span class="">
</span><span class="keyword1"><span class="command">qed</span></span><span class="">
</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">nat_to_string_inject2</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">fixes</span></span><span class=""> </span><span class="">i</span><span class=""> </span><span class="">j</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="">nat</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">assumes</span></span><span class=""> </span><span class="string">&quot;nat_to_string i = nat_to_string j&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">shows</span></span><span class=""> </span><span class="string">&quot;i = j&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">assms</span><span class=""> 
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">i</span><span class=""> </span><span class="">arbitrary</span><span class="delimiter">:</span><span class=""> </span><span class="">j</span><span class=""> </span><span class="">rule</span><span class="delimiter">:</span><span class=""> </span><span class="">nat_to_string.induct</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">rename_tac</span><span class=""> </span><span class="">i</span><span class=""> </span><span class="">j</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">case_tac</span><span class=""> </span><span class="string">&quot;i &lt; length digit_char_list&quot;</span><span class="delimiter">;</span><span class=""> </span><span class="">case_tac</span><span class=""> </span><span class="string">&quot;j &lt; length digit_char_list&quot;</span><span class="delimiter">)</span><span class=""> 
</span><span class="keyword1"><span class="command">proof</span></span><span class=""> </span><span class="">goal_cases</span><span class="">
</span><span class="">  </span><span class="keyword3"><span class="command">case</span></span><span class=""> </span><span class="delimiter">(</span><span class="">1</span><span class=""> </span><span class="">i</span><span class=""> </span><span class="">j</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">then</span></span><span class=""> </span><span class="keyword3"><span class="command">show</span></span><span class=""> </span><span class="var">?case</span><span class=""> </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">digit_char_list_inject</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">force</span><span class="">
</span><span class="keyword1"><span class="command">next</span></span><span class="">
</span><span class="">  </span><span class="keyword3"><span class="command">case</span></span><span class=""> </span><span class="delimiter">(</span><span class="">2</span><span class=""> </span><span class="">i</span><span class=""> </span><span class="">j</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">then</span></span><span class=""> </span><span class="keyword3"><span class="command">show</span></span><span class=""> </span><span class="var">?case</span><span class=""> 
</span><span class="">    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">    </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">digit_char_list_inject</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="delimiter">(</span><span class="">no_types</span><span class="delimiter">)</span><span class=""> </span><span class="">append_is_Nil_conv</span><span class=""> </span><span class="">list.distinct</span><span class="delimiter">(</span><span class="">1</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command">next</span></span><span class="">
</span><span class="">  </span><span class="keyword3"><span class="command">case</span></span><span class=""> </span><span class="delimiter">(</span><span class="">3</span><span class=""> </span><span class="">i</span><span class=""> </span><span class="">j</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">then</span></span><span class=""> </span><span class="keyword3"><span class="command">show</span></span><span class=""> </span><span class="var">?case</span><span class=""> 
</span><span class="">    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">    </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">digit_char_list_inject</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">append_is_Nil_conv</span><span class=""> </span><span class="">list.distinct</span><span class="delimiter">(</span><span class="">1</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="command">next</span></span><span class="">
</span><span class="">  </span><span class="keyword3"><span class="command">case</span></span><span class=""> </span><span class="delimiter">(</span><span class="">4</span><span class=""> </span><span class="">i</span><span class=""> </span><span class="">j</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">then</span></span><span class=""> </span><span class="keyword3"><span class="command">show</span></span><span class=""> </span><span class="var">?case</span><span class=""> 
</span><span class="">    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span class="">cases</span><span class=""> </span><span class="string">&quot;j div 10 &lt; 10&quot;</span><span class="delimiter">)</span><span class="">
</span><span class="">    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">    </span><span class="keyword1"><span class="command">proof</span></span><span class=""> </span><span class="">goal_cases</span><span class="">
</span><span class="">    </span><span class="keyword3"><span class="command">case</span></span><span class=""> </span><span class="">1</span><span class=""> 
</span><span class="">      </span><span class="keyword1"><span class="command">from</span></span><span class=""> </span><span class="">1</span><span class="delimiter">(</span><span class="">2</span><span class="delimiter">)</span><span class=""> </span><span class="keyword1"><span class="command">have</span></span><span class=""> </span><span class="string">&quot;(i div 10) = (j div 10)&quot;</span><span class=""> </span><span class="string">&quot;(i mod 10) = (j mod 10)&quot;</span><span class=""> 
</span><span class="">      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">1</span><span class="delimiter">)</span><span class=""> </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">digit_char_list_inject2</span><span class=""> </span><span class="">1</span><span class="delimiter">(</span><span class="">2</span><span class="delimiter">,</span><span class="">5</span><span class="delimiter">)</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">      </span><span class="keyword3"><span class="command">thus</span></span><span class=""> </span><span class="var">?case</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">mult_div_mod_eq</span><span class="delimiter">)</span><span class="">
</span><span class="">    </span><span class="keyword1"><span class="command">next</span></span><span class="">
</span><span class="">    </span><span class="keyword3"><span class="command">case</span></span><span class=""> </span><span class="">2</span><span class=""> 
</span><span class="">      </span><span class="keyword1"><span class="command">then</span></span><span class=""> </span><span class="keyword1"><span class="command">have</span></span><span class=""> </span><span class="">0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;nat_to_string (i div 10 div length digit_char_list) @ [digit_char_list ! (i div 10 mod length digit_char_list)] =
      nat_to_string (j div 10 div length digit_char_list) @ [digit_char_list ! (j div 10 mod length digit_char_list)]&quot;</span><span class="">
</span><span class="">        </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">append1_eq_conv</span><span class=""> </span><span class="">digit_char_list_length</span><span class=""> </span><span class="">nat_to_string.simps</span><span class="delimiter">)</span><span class="">
</span><span class="">      </span><span class="keyword1"><span class="command">with</span></span><span class=""> </span><span class="">2</span><span class=""> </span><span class="keyword1"><span class="command">have</span></span><span class=""> </span><span class="">1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;nat_to_string (i div 10 div length digit_char_list) = nat_to_string (j div 10 div length digit_char_list)&quot;</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">   
</span><span class="">      </span><span class="keyword1"><span class="command">with</span></span><span class=""> </span><span class="">0</span><span class=""> </span><span class="keyword1"><span class="command">have</span></span><span class=""> </span><span class="string">&quot;digit_char_list ! (i div 10 mod length digit_char_list) = digit_char_list ! (j div 10 mod length digit_char_list)&quot;</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">      </span><span class="keyword1"><span class="command">with</span></span><span class=""> </span><span class="">0</span><span class=""> </span><span class="">1</span><span class=""> </span><span class="">2</span><span class=""> </span><span class="keyword1"><span class="command">have</span></span><span class=""> </span><span class="string">&quot;i div 10 = j div 10&quot;</span><span class=""> </span><span class="string">&quot;i mod 10 = j mod 10&quot;</span><span class=""> </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">digit_char_list_inject2</span><span class=""> </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="">2</span><span class=""> 
</span><span class="">        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">append1_eq_conv</span><span class=""> </span><span class="">digit_char_list_length</span><span class=""> </span><span class="">nat_to_string.simps</span><span class="delimiter">)</span><span class="">
</span><span class="">        </span><span class="keyword1"><span class="command">using</span></span><span class=""> </span><span class="string">&quot;4&quot;</span><span class="delimiter">(</span><span class="">2</span><span class="delimiter">,</span><span class="">3</span><span class="delimiter">,</span><span class="">4</span><span class="delimiter">)</span><span class=""> </span><span class="">digit_char_list_inject2</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">      </span><span class="keyword3"><span class="command">thus</span></span><span class=""> </span><span class="var">?case</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">mult_div_mod_eq</span><span class="delimiter">)</span><span class="">
</span><span class="">    </span><span class="keyword1"><span class="command">qed</span></span><span class="">
</span><span class="keyword1"><span class="command">qed</span></span><span class="">
</span><span class="">
</span><span class="">
</span><span class="keyword2"><span class="keyword">end</span></span></pre>

</div>
</body>
</html>
